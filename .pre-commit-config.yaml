#
# Copyright 2023 ABSA Group Limited
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

# Pre-commit hooks configuration
# Install: pip install pre-commit && pre-commit install
# Run manually: pre-commit run --all-files
# Update hooks: pre-commit autoupdate

repos:
  # General file formatting hooks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: trailing-whitespace
        name: Trim trailing whitespace
      - id: end-of-file-fixer
        name: Fix end of files
      - id: check-yaml
        name: Check YAML syntax
      - id: check-added-large-files
        name: Check for large files
        args: ['--maxkb=500']
      - id: check-merge-conflict
        name: Check for merge conflicts
      - id: check-case-conflict
        name: Check for case conflicts
      - id: mixed-line-ending
        name: Fix mixed line endings

  # Black - Python code formatter (matching project config in pyproject.toml)
  # Note: Hook versions (rev:) are managed by 'pre-commit autoupdate', not dependabot
  # These are independent from the Python package versions in requirements.txt
  - repo: https://github.com/psf/black
    rev: 26.1.0
    hooks:
      - id: black
        name: Format code with Black
        language_version: python3
        args: ['--config=pyproject.toml']

  # Pylint - Python static code analysis (matching project requirements)
  - repo: https://github.com/pycqa/pylint
    rev: v4.0.4
    hooks:
      - id: pylint
        name: Lint with Pylint
        args: ['--rcfile=.pylintrc', '--score=y']
        exclude: ^tests/
        additional_dependencies: [requests==2.32.5, PyYAML==6.0.3, semver==3.0.4]
        # Note: Pylint runs on staged files only. For full project check, use: pylint $(git ls-files '*.py')

  # mypy - Python type checker (matching project config in pyproject.toml)
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.19.1
    hooks:
      - id: mypy
        name: Type check with mypy
        args: ['--config-file=pyproject.toml']
        exclude: ^tests/
        additional_dependencies:
          - types-requests==2.32.4.20260107
          - types-PyYAML==6.0.12.20250915
          - requests==2.32.5
          - PyYAML==6.0.3

# CI mode configuration (currently disabled)
# This section is for pre-commit.ci service integration, which provides:
# - Automatic pre-commit hook execution on pull requests
# - Auto-fixes pushed directly to PR branches
# - Automatic hook version updates
# 
# To enable pre-commit.ci:
# 1. Uncomment the 'ci:' section below
# 2. Sign up at https://pre-commit.ci and enable for this repository
# 3. The service will automatically run hooks on PRs and push fixes
#
# Note: This is separate from the GitHub Actions pre-commit job in test.yml
# 
# ci:
#   autofix_commit_msg: '[pre-commit.ci] auto fixes from pre-commit hooks'
#   autoupdate_commit_msg: '[pre-commit.ci] pre-commit autoupdate'
